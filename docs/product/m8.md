# M8 — Packaging & Distribution

## Goal
Ship the app as a trustworthy, easy-to-install desktop application for macOS and Windows, with proper code signing and notarization so that typical users can install and run it without fighting OS security dialogs.

M8 is about **how** we deliver the app, not new booking features. The functional behavior from M1–M7 is assumed to be in place; this milestone focuses on packaging, signing, and a minimal first-run experience.

## Primary User Stories
- **As a Mac user**, I want to download a DMG/ZIP, install the app, and launch it without scary “unidentified developer” warnings, so I feel confident running it.
- **As a Windows user**, I want to install the app via a familiar installer (MSI/EXE) that is signed and passes SmartScreen checks, so it doesn’t feel sketchy or unsafe.
- **As the developer**, I want a repeatable build & packaging process I can run on my machine (and later CI), so I can ship new versions without manual one-off steps.
- **As a tester**, I want clear versioning (e.g., `v0.8.0-alpha`) and a simple way to confirm which build I’m running, so I can report issues accurately.

## Scope

### In Scope
- **Packaging**
  - macOS build: signed + notarized DMG or ZIP using `electron-builder` (or equivalent).
  - Windows build: signed MSI/EXE installer using `electron-builder` (or equivalent).
  - App metadata: name, icon, version, copyright.
- **Code Signing**
  - Use a proper code signing certificate (or Apple Developer ID) for macOS.
  - Use a code signing certificate for Windows builds.
  - Configure signing hooks in the packaging pipeline.
- **Basic Install/Upgrade Experience**
  - Install over-the-top for minor versions without requiring a manual uninstall.
  - Preserve app configuration (if/when we add persistent config).
  - Ensure first-run opens the main window with RA loaded.
- **Distribution**
  - Build macOS and Windows artifacts locally.
  - Upload versioned artifacts to a private shared Drive folder (e.g., `/releases/v0.8.0/`).
  - Share Drive links directly with the small set of users/testers.
- **Environment & Documentation**
  - Document the build & packaging process in `README`/docs.
  - Provide minimal troubleshooting notes for common installer issues.

### Out of Scope (M8)
- Auto-update infrastructure (e.g., Squirrel/autoUpdater).
- In-app update notifications or “Check for updates” UI.
- Crash reporting / telemetry setup.
- Advanced installer customization (custom pages, license selection, etc.).
- Multi-language installers.

## UX Requirements

### Installation Experience
- **macOS**
  - Downloaded DMG/ZIP opens with a branded app icon.
  - User can drag the app to `/Applications` (or the equivalent recommended flow).
  - On first launch, macOS Gatekeeper allows the app to open without extra “unidentified developer” bypass steps.
  - If macOS shows standard “downloaded from the internet” prompts, they should be the minimal default dialogs, not hard blocks.
- **Windows**
  - Installer has a recognizable product name and publisher information (from the signing cert).
  - SmartScreen should show the publisher and not block the install as “unrecognized” after reputation is built.
  - Install location is reasonable by default (e.g., `%LOCALAPPDATA%` via Electron defaults).

### First-Run Experience
- First launch should:
  - Open a single main window with RA loaded in the embedded browser.
  - Show the existing sidebar with context and booking form (from previous milestones).
  - Not show any debug/logging windows by default (dev tools closed).
- If something prevents loading RA (e.g., offline), show an understandable message rather than a blank window.

### Versioning & Branding
- App displays a **version string** (e.g., in the window title or an “About” dialog) so testers can identify builds.
- Use consistent app name and icon across macOS and Windows.
- All references in installers and app metadata should match the product name used in docs.

## Acceptance Criteria
- **Packaging**
  - `npm run dist` (or equivalent) produces:
    - A signed & notarized macOS artifact (DMG/ZIP).
    - A signed Windows installer (MSI/EXE).
  - Artifacts are small enough to be reasonably downloadable (no unnecessary dev dependencies bundled).
- **Signing**
  - macOS build runs on a fresh macOS machine without Gatekeeper “unidentified developer” hard blocks.
  - Windows build is signed and reports the correct publisher in the installer properties.
  - Both platforms show the correct app name and icon in the OS UI (dock/taskbar, start menu, etc.).
- **Install/Run**
  - On both macOS and Windows:
    - Install succeeds without manual CLI steps.
    - User can launch the app from the standard OS app launcher.
    - The app opens RA in the embedded browser and the sidebar is functional.
  - Upgrading from one alpha build to another does not break the app or leave duplicate install entries.
- **Documentation**
  - `README` or a dedicated doc explains:
    - How to run local dev builds.
    - How to produce signed release builds.
    - Any required environment variables / certificates for signing.

## Risks & Mitigations
- **Certificate management complexity**
  - Risk: Signing certs (especially for macOS) are tricky to set up and maintain.
  - Mitigation: Document the local development vs. release-signing differences; keep signing steps in one script (`npm run dist`) to avoid mistakes.
- **Notarization delays**
  - Risk: Apple notarization can be slow or flaky, delaying builds.
  - Mitigation: Integrate notarization into the build pipeline and keep a small test project or a “notarization check” command to validate credentials ahead of a release.
- **False positives from AV/SmartScreen**
  - Risk: Early builds may trigger SmartScreen until reputation is built.
  - Mitigation: Keep the publisher consistent, sign every build, and document that early alpha builds might show extra prompts.

## Open Questions
- Artifacts will be hosted **privately** in a shared Drive folder, not on GitHub Releases or a public site.
- All builds are treated as **internal**; there is no separate “public” channel for now.
- Release cadence is **ad hoc**, tied to major feature milestones rather than a fixed schedule.



